<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Profil Saya - RZF Academy</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-sky-50 min-h-screen flex flex-col">

    <div id="toast-container" class="fixed top-5 right-5 z-[120] space-y-2"></div>

    <nav class="bg-gradient-to-r from-blue-600 to-sky-400 text-white px-4 py-3 flex justify-between items-center shadow-md">
        <a class="text-xl font-bold" href="dashboard.html">RZF Academy</a>
        <div class="hidden md:flex items-center space-x-4">
            <a href="dashboard.html" class="hover:text-sky-200">Dashboard</a>
            <a href="galeri.html" class="hover:text-sky-200">Galeri</a>
            <a href="text.html" class="hover:text-sky-200">Teks</a>
            <a href="upload.html" class="hover:text-sky-200">Upload</a>
            <a href="my.html" class="hover:text-sky-200">Konten Saya</a>
            <a id="adminLink" href="admin.html" class="px-3 py-1 bg-red-500 rounded-md text-white font-bold" style="display: none;">Panel Admin</a>
        </div>
        <div class="flex items-center space-x-4">
          <a href="profil.html" class="flex items-center space-x-3 group">
            <img id="navbarProfilePicture" src="https://placehold.co/32x32/e2e8f0/718096?text=U" alt="Foto Profil" class="w-8 h-8 rounded-full object-cover border-2 border-sky-200 group-hover:border-white transition">
            <span id="welcomeUser" class="font-semibold text-white group-hover:text-sky-200 transition">Pengguna</span>
          </a>
          <button onclick="logout()" class="px-3 py-1 border border-white rounded hover:bg-white hover:text-blue-600 text-sm font-semibold">Logout</button>
        </div>
    </nav>

    <main class="flex-1 container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="md:col-span-1">
                <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Foto Profil</h3>
                    <img id="profilePicturePreview" src="https://placehold.co/128x128/e2e8f0/718096?text=Foto" alt="Foto Profil" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-white shadow-md">
                    <input type="file" id="profilePictureInput" class="hidden" accept="image/*" onchange="previewImage()">
                    <button onclick="document.getElementById('profilePictureInput').click()" class="w-full bg-sky-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-sky-600 transition duration-300 text-sm">Ubah Foto</button>
                </div>
            </div>
            <div class="md:col-span-2 space-y-8">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Edit Detail Profil</h3>
                    <form onsubmit="handleProfileUpdate(event)" class="space-y-4">
                        <div><label for="nama" class="block text-sm font-medium text-gray-700 mb-1">Nama</label><input type="text" id="nama" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-400" required></div>
                        <div><label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label><input type="email" id="email" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-400" required></div>
                        <button type="submit" class="w-full bg-green-500 text-white font-bold py-2 px-4 rounded-md hover:bg-green-600 transition duration-300">Simpan Perubahan</button>
                    </form>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Ubah Kata Sandi</h3>
                    <form onsubmit="handlePasswordChange(event)" class="space-y-4">
                        <div><label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-1">Kata Sandi Saat Ini</label><input type="password" id="currentPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-400" required></div>
                        <div><label for="newPassword" class="block text-sm font-medium text-gray-700 mb-1">Kata Sandi Baru</label><input type="password" id="newPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-400" required></div>
                        <div><label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Konfirmasi Kata Sandi Baru</label><input type="password" id="confirmPassword" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-sky-400" required></div>
                        <button type="submit" class="w-full bg-red-500 text-white font-bold py-2 px-4 rounded-md hover:bg-red-600 transition duration-300">Ubah Kata Sandi</button>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-100 text-center text-gray-600 py-4 text-sm mt-auto">
        &copy; 2025 <a href="https://portfolio-chx.netlify.app/" class="font-semibold text-black hover:underline">CHX</a> â€¢ All rights reserved.
    </footer>

    <script>
        let loggedInUser=null;function showToast(e,t="success"){const o=document.getElementById("toast-container"),n=document.createElement("div"),s={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};n.className=`w-auto max-w-xs p-4 text-white rounded-lg shadow-lg ${s[t]||s.info} animate-fade-in-right`,n.textContent=e;const a=document.createElement("style");a.innerHTML="@keyframes fade-in-right{from{opacity:0;transform:translateX(100%)}to{opacity:1;transform:translateX(0)}}.animate-fade-in-right{animation:fade-in-right .5s ease-out forwards}",document.head.appendChild(a),o.appendChild(n),setTimeout(()=>n.remove(),3e3)}function logout(){localStorage.removeItem("loggedInUser"),showToast("Anda telah berhasil logout."),setTimeout(()=>{window.location.href="index.html"},1500)}function cekLogin(){loggedInUser=JSON.parse(localStorage.getItem("loggedInUser"));if(!loggedInUser)return showToast("Silakan login terlebih dahulu.","error"),setTimeout(()=>{window.location.href="login.html"},1500),!1;const e=document.getElementById("welcomeUser"),t=document.getElementById("navbarProfilePicture"),o=document.getElementById("adminLink");return e&&(e.textContent=loggedInUser.name),t&&loggedInUser.profilePicture&&(t.src=loggedInUser.profilePicture),o&&"admin"===loggedInUser.role&&(o.style.display="inline-block"),!0}function loadProfile(){cekLogin()&&(document.getElementById("nama").value=loggedInUser.name,document.getElementById("email").value=loggedInUser.email,loggedInUser.profilePicture&&(document.getElementById("profilePicturePreview").src=loggedInUser.profilePicture))}function previewImage(){const e=document.getElementById("profilePictureInput").files[0];if(e){const t=new FileReader;t.onload=function(e){document.getElementById("profilePicturePreview").src=e.target.result},t.readAsDataURL(e)}}function handleProfileUpdate(e){e.preventDefault();const t=document.getElementById("nama").value,o=document.getElementById("email").value,n=document.getElementById("profilePicturePreview").src;let s=JSON.parse(localStorage.getItem("users")||"[]");const a=s.findIndex(e=>e.id===loggedInUser.id);-1!==a&&(loggedInUser.name=t,loggedInUser.email=o,n.startsWith("data:image")&&(loggedInUser.profilePicture=n),s[a]=loggedInUser,localStorage.setItem("users",JSON.stringify(s)),localStorage.setItem("loggedInUser",JSON.stringify(loggedInUser)),showToast("Profil berhasil diperbarui!"))}function handlePasswordChange(e){e.preventDefault();const t=document.getElementById("currentPassword").value,o=document.getElementById("newPassword").value,n=document.getElementById("confirmPassword").value,s=e.target;if(t!==loggedInUser.password)return void showToast("Kata sandi saat ini salah.","error");if(!o||o!==n)return void showToast("Kata sandi baru tidak cocok atau kosong.","error");let a=JSON.parse(localStorage.getItem("users")||"[]");const i=a.findIndex(e=>e.id===loggedInUser.id);loggedInUser.password=o,a[i]=loggedInUser,localStorage.setItem("users",JSON.stringify(a)),localStorage.setItem("loggedInUser",JSON.stringify(loggedInUser)),showToast("Kata sandi berhasil diubah!"),s.reset()}
        document.addEventListener('DOMContentLoaded', loadProfile);
    </script>
</body>
</html>