<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RZF Academy - Beranda</title>
    <link rel="stylesheet" href="dist/output.css">
    <style>
        /* Cursor berkedip untuk efek typing */
        .typing-cursor {
            display: inline-block;
            width: 3px;
            background-color: white;
            animation: blink 0.7s infinite;
            margin-left: 2px;
            vertical-align: middle;
            height: 1.2em;
            /* Sesuaikan dengan tinggi font teks */
        }

        @keyframes blink {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }
    </style>
</head>

<body class="bg-sky-50 min-h-screen flex flex-col">

    <nav
        class="bg-gradient-to-r from-blue-600 to-sky-400 text-white px-4 py-3 flex justify-between items-center shadow-md">
        <h1 class="text-xl font-bold">RZF Academy</h1>
        <div class="space-x-2">
            <a href="login.html"
                class="px-4 py-1 border border-white rounded hover:bg-white hover:text-blue-600 text-sm font-semibold">Login</a>
            <a href="registrasi.html"
                class="px-4 py-1 bg-white text-blue-600 rounded hover:bg-blue-100 text-sm font-bold">Register</a>
        </div>
    </nav>

    <main class="flex-1 container mx-auto px-4 py-8">
        <!-- Hero Section -->
        <section
            class="text-center mb-16 py-16 bg-gradient-to-br from-blue-500 to-sky-300 text-white rounded-xl shadow-lg">
            <h2 class="text-4xl md:text-5xl font-extrabold mb-4 leading-tight">
                Selamat Datang di <span class="block text-yellow-200">RZF Academy</span>
            </h2>
            <p class="text-lg md:text-xl mb-8 max-w-2xl mx-auto">
                Platform inovatif untuk berbagi dan menemukan inspirasi melalui
                <span id="typing-text" class="font-semibold text-yellow-100"></span><span class="typing-cursor"></span>
            </p>
            <div class="space-x-4">
                <a href="registrasi.html"
                    class="bg-white text-blue-600 px-6 py-3 rounded-full font-bold text-lg hover:bg-blue-100 transition duration-300 shadow-md">
                    Gabung Sekarang!
                </a>
                <a href="login.html"
                    class="border border-white text-white px-6 py-3 rounded-full font-semibold text-lg hover:bg-white hover:text-blue-600 transition duration-300 shadow-md">
                    Login
                </a>
            </div>
        </section>

        <!-- About Section -->
        <section class="mb-16 py-8">
            <h3 class="text-3xl font-bold text-blue-600 text-center mb-8">Tentang RZF Academy</h3>
            <div class="bg-white p-8 rounded-xl shadow-lg max-w-3xl mx-auto text-gray-700 leading-relaxed">
                <p class="mb-4">
                    RZF Academy adalah wadah digital yang dirancang untuk para kreator dan penikmat seni. Kami percaya
                    bahwa setiap orang memiliki potensi kreatif yang unik, dan platform ini hadir untuk memfasilitasi
                    Anda dalam berbagi ide, karya, serta mendapatkan inspirasi dari orang lain.
                </p>
                <p class="mb-4">
                    Mulai dari fotografer, penulis, desainer, hingga siapa pun yang memiliki cerita untuk dibagikan, RZF
                    Academy menyediakan ruang yang intuitif dan menarik. Kami berkomitmen untuk membangun komunitas yang
                    suportif dan inspiratif, di mana setiap karya dihargai.
                </p>
                <p>
                    Bergabunglah dengan kami dan jadilah bagian dari gerakan kreatif yang terus berkembang!
                </p>
            </div>
        </section>

        <!-- Features Section -->
        <section class="mb-16 py-8">
            <h3 class="text-3xl font-bold text-blue-600 text-center mb-8">Fitur Unggulan Kami</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <div class="bg-white p-6 rounded-xl shadow-lg text-center hover:shadow-xl transition duration-300">
                    <div class="text-blue-500 text-5xl mb-4">üñºÔ∏è</div>
                    <h4 class="font-bold text-xl text-gray-800 mb-2">Galeri Visual Memukau</h4>
                    <p class="text-gray-600">Unggah dan jelajahi berbagai foto dan karya visual dari komunitas.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg text-center hover:shadow-xl transition duration-300">
                    <div class="text-green-500 text-5xl mb-4">‚úçÔ∏è</div>
                    <h4 class="font-bold text-xl text-gray-800 mb-2">Konten Teks Inspiratif</h4>
                    <p class="text-gray-600">Baca dan bagikan artikel, cerita, atau puisi yang menggugah pikiran.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg text-center hover:shadow-xl transition duration-300">
                    <div class="text-purple-500 text-5xl mb-4">üöÄ</div>
                    <h4 class="font-bold text-xl text-gray-800 mb-2">Unggah Karya Mudah</h4>
                    <p class="text-gray-600">Antarmuka sederhana untuk mengunggah dan mengelola konten Anda.</p>
                </div>
            </div>
        </section>

        <!-- Latest Content Section -->
        <section class="mb-16 py-8">
            <h3 class="text-3xl font-bold text-blue-600 text-center mb-8">Konten Terbaru</h3>
            <div id="latestContentContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
                <!-- Konten terbaru akan dimuat di sini oleh JavaScript -->
                <p id="loadingLatestContent" class="col-span-full text-center text-gray-500">Memuat konten terbaru...
                </p>
            </div>
            <div class="text-center mt-8">
                <a href="login.html"
                    class="inline-block bg-blue-500 text-white px-6 py-3 rounded-full font-semibold hover:bg-blue-600 transition duration-300 shadow-md">
                    Lihat Semua Konten
                </a>
            </div>
        </section>

        <!-- Call to Action Section -->
        <section class="text-center py-12 bg-gradient-to-tl from-sky-400 to-blue-600 text-white rounded-xl shadow-lg">
            <h3 class="text-3xl md:text-4xl font-bold mb-4">Siap Berkreasi?</h3>
            <p class="text-lg md:text-xl mb-8 max-w-2xl mx-auto">
                Daftar sekarang dan mulailah perjalanan kreatif Anda bersama RZF Academy!
            </p>
            <a href="registrasi.html"
                class="bg-white text-blue-600 px-8 py-4 rounded-full font-bold text-xl hover:bg-blue-100 transition duration-300 shadow-lg">
                Daftar Gratis
            </a>
        </section>

    </main>

    <!-- Modal for content preview (re-added for latest content section) -->
    <div id="previewOverlay" class="fixed inset-0 bg-black bg-opacity-80 hidden justify-center items-center z-50">
        <span id="close-preview"
            class="absolute top-5 right-6 text-white text-4xl cursor-pointer font-bold">&times;</span>
        <img id="previewImage" class="max-w-[90%] max-h-[90%] rounded shadow-2xl" />
    </div>

    <div id="bacaModal" class="fixed inset-0 bg-black bg-opacity-70 hidden justify-center items-center z-50">
        <div class="bg-white max-w-xl w-full mx-4 p-6 rounded-xl shadow-lg relative">
            <button id="close-baca"
                class="absolute top-2 right-2 text-gray-600 hover:text-red-500 text-xl font-bold">‚úñ</button>
            <h2 id="judulBaca" class="text-xl font-bold mb-2 text-blue-700"></h2>
            <p id="isiBaca"
                class="text-gray-800 whitespace-pre-line leading-relaxed text-sm max-h-[60vh] overflow-y-auto"></p>
        </div>
    </div>


    <footer class="bg-gray-100 text-center text-gray-600 py-4 text-sm mt-auto">
        &copy; 2025 <a href="https://portfolio-chx.netlify.app/"
            class="font-semibold text-black hover:underline">CHX</a> ‚Ä¢ All rights reserved.
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
        import { getDatabase, ref, get, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-database.js";

        // --- KONFIGURASI FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyAZF0O1y9nqZAuDXgwMf3vucM5OD1goavQ",
            authDomain: "rzf-academy-bd.firebaseapp.com",
            databaseURL: "https://rzf-academy-bd-default-rtdb.firebaseio.com",
            projectId: "rzf-academy-bd",
            storageBucket: "rzf-academy-bd.appspot.com",
            messagingSenderId: "875822158869",
            appId: "1:875822158869:web:a88c284f1d031d9da3aa1c",
        };

        // --- INISIALISASI FIREBASE ---
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // --- UI Elements for Modals ---
        const previewOverlay = document.getElementById("previewOverlay");
        const previewImage = document.getElementById("previewImage");
        const bacaModal = document.getElementById("bacaModal");
        const judulBaca = document.getElementById("judulBaca");
        const isiBaca = document.getElementById("isiBaca");

        // --- Utility Functions for Modals ---
        const tampilkanPreview = (src) => {
            previewImage.src = src;
            previewOverlay.style.display = "flex";
            document.body.style.overflow = 'hidden';
        };

        const bukaBaca = (judul, teks) => {
            judulBaca.textContent = judul;
            isiBaca.innerHTML = teks.replace(/\n/g, "<br>"); // Use innerHTML for line breaks
            bacaModal.style.display = "flex";
            document.body.style.overflow = 'hidden';
        };

        const tutupPreview = () => {
            previewOverlay.style.display = "none";
            document.body.style.overflow = '';
        };
        const tutupBaca = () => {
            bacaModal.style.display = "none";
            document.body.style.overflow = '';
        };


        // --- TYPING EFFECT LOGIC ---
        const typingTextElement = document.getElementById('typing-text');
        const phrases = [
            "karya visual",
            "tulisan inspiratif",
            "ide kreatif",
            "pengalaman baru"
        ];
        let phraseIndex = 0;
        let charIndex = 0;
        let isDeleting = false;
        const typingSpeed = 100; // milliseconds per character
        const deletingSpeed = 50; // milliseconds per character
        const pauseBeforeDelete = 1500; // milliseconds
        const pauseBeforeType = 500; // milliseconds

        function typeEffect() {
            const currentPhrase = phrases[phraseIndex];
            if (isDeleting) {
                typingTextElement.textContent = currentPhrase.substring(0, charIndex - 1);
                charIndex--;
            } else {
                typingTextElement.textContent = currentPhrase.substring(0, charIndex + 1);
                charIndex++;
            }

            let currentSpeed = isDeleting ? deletingSpeed : typingSpeed;

            if (!isDeleting && charIndex === currentPhrase.length) {
                currentSpeed = pauseBeforeDelete;
                isDeleting = true;
            } else if (isDeleting && charIndex === 0) {
                isDeleting = false;
                phraseIndex = (phraseIndex + 1) % phrases.length;
                currentSpeed = pauseBeforeType;
            }

            setTimeout(typeEffect, currentSpeed);
        }


        // --- FETCH LATEST CONTENT LOGIC ---
        const latestContentContainer = document.getElementById('latestContentContainer');
        const loadingLatestContent = document.getElementById('loadingLatestContent');
        const ITEMS_TO_SHOW = 2; // Hanya tampilkan 2 data terbaru

        const fetchLatestContent = async () => {
            loadingLatestContent.style.display = 'block'; // Tampilkan loading
            latestContentContainer.innerHTML = ''; // Kosongkan container

            const kontenRef = ref(db, 'konten');
            // Ambil N item terbaru berdasarkan waktu (limitToLast akan mengambil N item terakhir secara kronologis)
            const latestContentQuery = query(kontenRef, orderByChild('waktu'), limitToLast(ITEMS_TO_SHOW));

            try {
                const snapshot = await get(latestContentQuery);
                const fetchedItems = [];
                snapshot.forEach(child => {
                    fetchedItems.push(child.val());
                });

                // Karena limitToLast mengambil yang paling lama dari N terakhir, kita perlu membalik urutannya
                fetchedItems.reverse();

                if (fetchedItems.length === 0) {
                    latestContentContainer.innerHTML = `<p class="col-span-full text-center text-gray-500">Belum ada konten terbaru.</p>`;
                    return;
                }

                fetchedItems.forEach(item => {
                    const card = document.createElement("div");
                    card.className = "bg-white rounded-lg shadow hover:shadow-lg p-4 flex flex-col transition-shadow";
                    const placeholder = 'https://placehold.co/24x24/e2e8f0/718096?text=U'; // Placeholder untuk gambar profil

                    if (item.jenis === 'gambar') {
                        card.innerHTML = `
                            <div>
                                <img src="${item.gambar || 'https://placehold.co/400x250?text=Gambar+Hilang'}" alt="${item.judul}" class="w-full h-48 object-contain bg-gray-100 rounded mb-3 shadow-sm cursor-pointer"/>
                                <h4 class="text-lg font-semibold text-blue-700 truncate mb-1">${item.judul}</h4>
                            </div>
                            <div class="mt-auto pt-3 border-t flex items-center justify-between">
                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">${item.kategori}</span>
                                <div class="flex items-center gap-2">
                                    <img src="${item.userProfilePicture || placeholder}" class="w-6 h-6 rounded-full object-cover" />
                                    <span class="text-gray-500 text-xs">${item.userName}</span>
                                </div>
                            </div>`;
                        // Listener untuk preview gambar
                        const imgElement = card.querySelector('img');
                        imgElement.addEventListener('click', (e) => {
                            e.stopPropagation();
                            tampilkanPreview(item.gambar);
                        });
                    } else if (item.jenis === 'teks') {
                        const fullText = item.teks || "";
                        const preview = fullText.slice(0, 150).replace(/\n/g, "<br>"); // Preview 150 karakter
                        card.innerHTML = `
                            <div>
                                <h4 class="text-lg font-semibold text-blue-700 mb-2">${item.judul}</h4>
                                <p class="text-gray-800 leading-relaxed min-h-[64px] break-words">${preview}${fullText.length > 150 ? '...' : ''}</p>
                                ${fullText.length > 150 ? `<div class="mt-2"><button class="text-sm text-blue-600 hover:underline baca-btn">Baca Selengkapnya</button></div>` : ''}
                            </div>
                            <div class="mt-auto pt-3 border-t flex items-center justify-between">
                                <span class="bg-indigo-100 text-indigo-800 text-xs font-medium px-2.5 py-0.5 rounded">${item.kategori}</span>
                                <div class="flex items-center gap-2">
                                    <img src="${item.userProfilePicture || placeholder}" class="w-6 h-6 rounded-full object-cover" />
                                    <span class="text-gray-500 text-xs">${item.userName}</span>
                                </div>
                            </div>`;
                        // Listener untuk modal "Baca Selengkapnya"
                        const bacaBtn = card.querySelector('.baca-btn');
                        if (bacaBtn) {
                            bacaBtn.addEventListener('click', (e) => {
                                e.stopPropagation();
                                bukaBaca(item.judul, item.teks);
                            });
                        }
                    }
                    latestContentContainer.appendChild(card);
                });

            } catch (error) {
                console.error("Error fetching latest content:", error);
                latestContentContainer.innerHTML = `<p class="col-span-full text-center text-red-500">Gagal memuat konten terbaru.</p>`;
            } finally {
                loadingLatestContent.style.display = 'none'; // Sembunyikan loading
            }
        };


        // --- DOM Loaded ---
        document.addEventListener('DOMContentLoaded', () => {
            // Start typing effect
            typeEffect();

            // Fetch and display latest content
            fetchLatestContent();

            // Event listeners for modals
            document.getElementById("close-preview").addEventListener('click', tutupPreview);
            previewOverlay.addEventListener('click', (e) => { if (e.target === previewOverlay) tutupPreview(); });
            document.getElementById("close-baca").addEventListener('click', tutupBaca);
            bacaModal.addEventListener('click', (e) => { if (e.target === bacaModal) tutupBaca(); });
        });
    </script>

</body>

</html>
